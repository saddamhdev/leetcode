ржЪрж▓ ржПржХржжржо **ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ** ржХрж░рж┐ тАУ ржпрзЗржи рждрзБржорж┐ ржХрзЛржб ржирж╛ ржжрзЗржЦрзЗржУ ржмрзБржЭрждрзЗ ржкрж╛рж░рзЛ ржХрзА рж╣ржЪрзНржЫрзЗред
Problem: **Diameter of Binary Tree (Medium)** тАУ LeetCode.

---

## 1я╕ПтГг Problem ржЯрж╛ ржХрзА ржЪрж╛ржЪрзНржЫрзЗ?

**Diameter** ржорж╛ржирзЗ:

> Binary tree-ржПрж░ ржоржзрзНржпрзЗ **ржпрзЗржХрзЛржирзЛ ржжрзБржЗржЯрж╛ node-ржПрж░ ржоржзрзНржпрзЗ рж╕ржмржЪрзЗрзЯрзЗ рж▓ржорзНржмрж╛ path** (edge count ржЕржирзБржпрж╛рзЯрзА)ред

* Path **root-ржПрж░ ржоржзрзНржп ржжрж┐рзЯрзЗ ржпрзЗрждрзЗржУ ржкрж╛рж░рзЗ, ржирж╛ржУ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ**ред
* Length = **number of edges**, node ржирж╛ред

---

## 2я╕ПтГг Core Idea (ржПржХржЯрж╛ ржирзЛржбржХрзЗ ржХрзЗржирзНржжрзНрж░ ржзрж░рзЗ ржнрж╛ржмрзЛ)

ржкрзНрж░рждрж┐ржЯрж╛ node-ржПрж░ ржЬржирзНржп ржнрж╛ржмрзЛ:

* `leftHeight` = рждрж╛рж░ left subtree-ржПрж░ height
* `rightHeight` = рждрж╛рж░ right subtree-ржПрж░ height

рждрж╛рж╣рж▓рзЗ ржПржЗ node ржжрж┐рзЯрзЗ ржпрж╛ржУрзЯрж╛ path-ржПрж░ length рж╣ржмрзЗ:

```text
pathThroughNode = leftHeight + rightHeight
```

ржЖржорж░рж╛ ржЪрж╛ржЗ **ржкрзБрж░рзЛ tree-рждрзЗ** ржПрж░ ржоржзрзНржпрзЗ **рж╕рж░рзНржмрзЛржЪрзНржЪржЯрж╛** тАФ рждрж╛ржЗ ржПржХржЯрж╛ global ржнрзЗрж░рж┐рзЯрзЗржмрж▓рзЗ рж░рж╛ржЦржмрзЛ:

```text
diameter = max(diameter, leftHeight + rightHeight)
```

ржЖрж░ ржлрж╛ржВрж╢ржиржЯрж╛ ржпрзЗ value return ржХрж░ржмрзЗ, рж╕рзЗржЯрж╛ рж╣ржмрзЗ height:

```text
height(node) = 1 + max(leftHeight, rightHeight)
```

ржПрждрзЗржЗ **ржПржХржЯрж╛ DFS-ржП height + diameter** ржжрзБржЗржЯрж╛ржЗ ржмрзЗрж░ рж╣рзЯрзЗ ржпрж╛рзЯред

---

## 3я╕ПтГг Algorithm Step-by-Step (Concept)

For each node:

1. ржпржжрж┐ node `null` рж╣рзЯ тЖТ height = 0
2. Recursively:

   * left subtree-ржПрж░ height ржмрзЗрж░ ржХрж░рзЛ
   * right subtree-ржПрж░ height ржмрзЗрж░ ржХрж░рзЛ
3. ржПржЗ node ржжрж┐рзЯрзЗ ржпрзЗ path ржпрж╛рзЯ, рждрж╛рж░ length:

   * `leftHeight + rightHeight`
4. Global `diameter` ржЖржкржбрзЗржЯ ржХрж░рзЛ:

   * `diameter = max(diameter, leftHeight + rightHeight)`
5. ржПржЗ node-ржПрж░ height return ржХрж░рзЛ:

   * `1 + max(leftHeight, rightHeight)`

рж╢рзЗрж╖рзЗ `diameterOfBinaryTree(root)` ржерзЗржХрзЗ `diameter` return ржХрж░ржмрзЛред

---

## 4я╕ПтГг Java Code

```java
class Solution {
    int diameter = 0;  // global (class level) variable

    public int diameterOfBinaryTree(TreeNode root) {
        height(root);        // DFS call
        return diameter;     // final answer
    }

    // height(node) returns: height of subtree rooted at node
    private int height(TreeNode node) {
        if (node == null) return 0;

        int left = height(node.left);    // height of left subtree
        int right = height(node.right);  // height of right subtree

        // path through this node = left + right
        diameter = Math.max(diameter, left + right);

        // return height of this node
        return 1 + Math.max(left, right);
    }
}
```

---

## 5я╕ПтГг Dry Run тАУ Step by Step (Very Important)

ржзрж░рзЛ treeржЯрж╛:

```text
        1
       / \
      2   3
     / \
    4   5
```

### Step 0: рж╢рзБрж░рзБ

* `diameter = 0`
* call: `height(1)`

---

### Step 1: `height(1)`

* ржкрзНрж░ржержорзЗ `height(1.left)` тЖТ `height(2)`
* рждрж╛рж░ржкрж░ `height(1.right)` тЖТ `height(3)`

---

### Step 2: `height(2)`

* ржПрж░ ржЖржЧрзЗржУ ржпрж╛ржмрзЗ:

  * `height(2.left)` тЖТ `height(4)`
  * `height(2.right)` тЖТ `height(5)`

---

### Step 3: `height(4)`

* `4` ржПрж░ left = null тЖТ `height(null) = 0`
* `4` ржПрж░ right = null тЖТ `height(null) = 0`

So:

* `left = 0`, `right = 0`
* `diameter = max(0, 0 + 0) = 0`
* `height(4) = 1 + max(0, 0) = 1` тЖТ return 1 ржЙржкрж░рзЗ `2` ржХрзЗ

---

### Step 4: `height(5)`

`5` ржПрж░ржУ same:

* `left = 0`, `right = 0`
* `diameter = max(0, 0 + 0) = 0`
* `height(5) = 1 + max(0, 0) = 1` тЖТ return 1 ржЙржкрж░рзЗ `2` ржХрзЗ

---

### Step 5: Back to `height(2)`

ржПржЦржи:

* `left = height(4) = 1`
* `right = height(5) = 1`

So:

* ржПржЗ node ржжрж┐рзЯрзЗ path length = `left + right = 1 + 1 = 2`
* `diameter = max(0, 2) = 2`  тЬЕ (ржПржЦржи ржкрж░рзНржпржирзНржд best path length = 2 edges)
* `height(2) = 1 + max(1, 1) = 2` тЖТ return 2 ржЙржкрж░рзЗ `1` ржХрзЗ

---

### Step 6: `height(3)`

`3` ржПрж░:

* left child = null тЖТ `0`
* right child = null тЖТ `0`

So:

* `left = 0`, `right = 0`
* `diameter = max(2, 0 + 0) = 2` (unchanged)
* `height(3) = 1 + max(0, 0) = 1` тЖТ return 1 ржЙржкрж░рзЗ `1` ржХрзЗ

---

### Step 7: Back to `height(1)`

ржПржЦржи:

* `left = height(2) = 2`
* `right = height(3) = 1`

So:

* ржПржЗ node ржжрж┐рзЯрзЗ path length = `left + right = 2 + 1 = 3`
* `diameter = max(2, 3) = 3` тЬЕ (final best path length)
* `height(1) = 1 + max(2, 1) = 3` (ржПржЯрж╛ рж╢рзБржзрзБ height; main answer ржирж╛)

DFS рж╢рзЗрж╖ тЖТ `diameter = 3`

---

## 6я╕ПтГг Final Answer for ржПржЗ Tree

* Diameter = **3 edges**
* Path example: `4 тЖТ 2 тЖТ 1 тЖТ 3`

---

## 7я╕ПтГг ржПржХ рж▓рж╛ржЗржирзЗ ржоржирзЗ рж░рж╛ржЦрзЛ

> **ржПржХржЯрж╛ DFS function height return ржХрж░рзЗ, ржЖрж░ side-effect рж╣рж┐рж╕рзЗржмрзЗ `diameter = max(diameter, leftHeight + rightHeight)` ржЖржкржбрзЗржЯ ржХрж░рзЗред**

---



ржЖржорж┐ ржПржЗ ржжрзБржЗ рж▓рж╛ржЗржи **ржПржХржжржо рж╕рж╣ржЬ ржнрж╛рж╖рж╛рзЯ, ржбрж╛рзЯрж╛ржЧрзНрж░рж╛ржо ржзрж░рзЗ** ржмрзНржпрж╛ржЦрзНржпрж╛ ржХрж░ржЫрж┐ тАФ ржпрж╛рждрзЗ рждрзБржорж┐ ржоржирзЗ рж░рж╛ржЦрждрзЗржЗ ржкрж╛рж░ржмрзЗ ЁЯСЗ

---

# тЬЕ рзз) `diameter = Math.max(diameter, left + right);`

### ЁЯСЙ ржПрж░ ржорж╛ржирзЗ:

ржПржЗ node-ржХрзЗ ржХрзЗржирзНржжрзНрж░ ржзрж░рзЗ **рж╕рж░рзНржмрзЛржЪрзНржЪ ржХржд рж▓ржорзНржмрж╛ path** ржпрзЗрждрзЗ ржкрж╛рж░рзЗ рждрж╛ ржмрзЗрж░ ржХрж░рж╛ред

ржХрж╛рж░ржг:

```
ржПржХржЯрж┐ node ржжрж┐рзЯрзЗ ржпрзЗ path ржпрж╛рзЯ = рждрж╛рж░ left side ржПрж░ height + рждрж╛рж░ right side ржПрж░ height
```

ржпрзЗржоржи:

```
      X
     / \
    L   R
```

* Left ржжрж┐ржХрзЗ ржирж┐ржЪрзЗ ржпржд ржжрзВрж░ ржпрж╛ржУрзЯрж╛ ржпрж╛рзЯ = `left`
* Right ржжрж┐ржХрзЗ ржирж┐ржЪрзЗ ржпржд ржжрзВрж░ ржпрж╛ржУрзЯрж╛ ржпрж╛рзЯ = `right`

рждрж╛рж╣рж▓рзЗ X ржжрж┐рзЯрзЗ ржпрж╛ржУрзЯрж╛ path length = `left + right`

ржЖржорж░рж╛ рж╕рзЗржЯрж╛ ржЖржЧрзЗрж░ diameter ржерзЗржХрзЗ ржмрзЬ рж╣рж▓рзЗ рж░рж╛ржЦрж┐:

```
diameter = max(previousDiameter, currentPath)
```

---

# тЬЕ рзи) `return 1 + Math.max(left, right);`

### ЁЯСЙ ржПрж░ ржорж╛ржирзЗ:

ржПржЗ node-ржПрж░ **height** ржХржд?

Height = ржмрж░рзНрждржорж╛ржи node + рждрж╛рж░ ржирж┐ржЪрзЗрж░ subtree-ржПрж░ рж╕ржмржЪрзЗржпрж╝рзЗ рж▓ржорзНржмрж╛ height.

ржЙржжрж╛рж╣рж░ржг:

```
      X
     / \
    L   R
```

ржпржжрж┐:

* `left = 2`
* `right = 5`

рждрж╛рж╣рж▓рзЗ height рж╣ржмрзЗ:

```
X height = 1 + max(left, right)
         = 1 + 5
         = 6
```

ржПржЗ height ржЯрж╛ ржлрж┐рж░рзЗ ржпрж╛рзЯ parent node-ржПред

---

# ЁЯОп ржПржХ ржХржерж╛рзЯ ржоржирзЗ рж░рж╛ржЦрзЛ:

### **(рзз) Diameter ржмрзЗрж░ рж╣рзЯ тЖТ left + right**

### **(рзи) Height ржлрзЗрж░ржд ржпрж╛рзЯ тЖТ 1 + max(left, right)**

---

# ЁЯФе рж╕ржорзНржкрзВрж░рзНржг рж▓ржЬрж┐ржХ ржПржХрж╕рж╛ржерзЗ (ржорзБржЦрж╕рзНрже ржХрж░рж╛рж░ ржорждрзЛ):

| ржХрж╛ржЬ                     | ржлрж░рзНржорзБрж▓рж╛                                  |
| ----------------------- | ---------------------------------------- |
| ржПржЗ node ржжрж┐рзЯрзЗ рж▓ржорзНржмрж╛ path | `left + right`                           |
| diameter ржЖржкржбрзЗржЯ          | `diameter = max(diameter, left + right)` |
| height return           | `1 + max(left, right)`                   |

---

# ЁЯМ│ ржЫрзЛржЯ ржЙржжрж╛рж╣рж░ржг

```
      1
     / \
    2   3
   / \
  4   5
```

Node 2 ржП ржЧрзЗрж▓рзЗ:

* left = height(4) = 1
* right = height(5) = 1

So:

```
diameter = max(diameter, 1 + 1) = 2
height = 1 + max(1, 1) = 2
```

---

ржпржжрж┐ ржЪрж╛ржУ, ржЖржорж┐ **ржПржХржЯрж╛ visualization/diagram** ржХрж░рзЗ ржжрзЗржЦрж╛рждрзЗ ржкрж╛рж░рж┐ ржПржЗ ржжрзБржЗ рж▓рж╛ржЗржи ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗред




ржпржжрж┐ ржЪрж╛ржУ, ржЖржорж┐:

* ржПржХржЗ ржЬрж┐ржирж┐рж╕рзЗрж░ **BFS/base intuition-only version** ржжрзЗржЦрж╛рждрзЗ ржкрж╛рж░рж┐
* ржЕржержмрж╛ рждрзБржорж┐ ржпрзЗ tree ржП ржЖржЯржХрзЗ ржЧрзЗржЫрзЛ, рж╕рзЗржЗ tree ржЯрж╛ ржирж┐рзЯрзЗ **exact trace** ржХрж░рзЗ ржжрзЗржЦрж╛рждрзЗ ржкрж╛рж░рж┐ (рждрзБржорж┐ tree ржЯрж╛ рж▓рж┐ржЦрзЗ ржжрж┐рж▓рзЗ)ред
